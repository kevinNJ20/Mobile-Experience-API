#%RAML 1.0
title: Mobile Experience API
version: 1.0.0
mediaType: application/json

documentation:
  - title: Overview
    content: API d'expérience mobile pour fournir une vue financière optimisée pour les applications mobiles

# Client ID Enforcement (policy appliquée dans API Manager)
securitySchemes:
  client-id-enforcement:
    type: Pass Through
    describedBy:
      headers:
        client_id:
          type: string
          required: true
          description: Client ID de l'application enregistrée dans API Manager
        client_secret:
          type: string
          required: false
          description: Client secret (si la policy l'exige)

securedBy: [ client-id-enforcement ]

types:
  FinancialSummary:
    type: object
    properties:
      customer:
        type: object
        properties:
          globalId: string
          customerNumber?: string
          party:
            type: object
            properties:
              firstName?: string
              lastName?: string
      accounts:
        type: array
        items:
          type: object
          properties:
            accountNumber: string
            accountType: string
            balance?: number
            currency?: string
      cards:
        type: array
        items:
          type: object
          properties:
            cardNumber: string
            cardType: string
            availableCredit?: number
            creditLimit?: number
      totalBalance?: number
      totalAvailableCredit?: number
    example:
      customer:
        globalId: "c1c27e05-7e59-4f39-a7f6-7ffe9ee10d64"
        customerNumber: "CUST-000001"
        party:
          firstName: "John"
          lastName: "Doe"
      accounts:
        - accountNumber: "ACC-123456789"
          accountType: "Checking"
          balance: 5000.00
          currency: "USD"
      cards:
        - cardNumber: "4532-1234-5678-9010"
          cardType: "CreditCard"
          availableCredit: 4500.00
          creditLimit: 5000.00
      totalBalance: 5000.00
      totalAvailableCredit: 4500.00
  CardControls:
    type: object
    properties:
      status?: string
      creditLimit?: number
      availableCredit?: number
      controls?:
        type: object
        properties:
          dailyPurchaseLimit?: number
          dailyATMWithdrawalLimit?: number
          internationalTransactionsEnabled?: boolean
          onlineTransactionsEnabled?: boolean
    example:
      status: "Active"
      creditLimit: 5000.00
      availableCredit: 4500.00
      controls:
        dailyPurchaseLimit: 1000.00
        dailyATMWithdrawalLimit: 500.00
        internationalTransactionsEnabled: true
        onlineTransactionsEnabled: true
  ErrorResponse:
    type: object
    properties:
      error:
        type: object
        properties:
          code: string
          message: string
    example:
      error:
        code: "BAD_REQUEST"
        message: "Invalid request parameters"

/customers/{customerGlobalId}:
  displayName: Customer Financial Summary
  uriParameters:
    customerGlobalId:
      type: string
      description: Identifiant global unique du client
  get:
    displayName: Get Mobile Financial Summary
    description: Récupère un résumé financier optimisé pour mobile
    responses:
      200:
        body:
          application/json:
            type: FinancialSummary
      400:
        body:
          application/json:
            type: ErrorResponse
      404:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

/customers/{customerGlobalId}/accounts/{accountGlobalId}/transactions:
  displayName: Account Transactions
  uriParameters:
    customerGlobalId:
      type: string
      description: Identifiant global unique du client
    accountGlobalId:
      type: string
      description: Identifiant global unique du compte
  get:
    displayName: Get Account Transactions
    description: Récupère les transactions d'un compte
    queryParameters:
      limit?:
        type: integer
        default: 100
      offset?:
        type: integer
        default: 0
    responses:
      200:
        body:
          application/json:
            type: object[]
      400:
        body:
          application/json:
            type: ErrorResponse
      404:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

  /{transactionGlobalId}/dispute:
    displayName: Dispute Transaction
    uriParameters:
      transactionGlobalId:
        type: string
        description: Identifiant global unique de la transaction
    put:
      displayName: Dispute Transaction
      description: Conteste une transaction
      body:
        application/json:
          type: object
          properties:
            disputeStatus?: string
            disputeReason?: string
          example:
            disputeStatus: "Initiated"
            disputeReason: "Unauthorized transaction"
      responses:
        200:
          body:
            application/json:
              type: object
        400:
          body:
            application/json:
              type: ErrorResponse
        404:
          body:
            application/json:
              type: ErrorResponse
        500:
          body:
            application/json:
              type: ErrorResponse

/customers/{customerGlobalId}/cards/{cardGlobalId}/controls:
  displayName: Card Controls
  uriParameters:
    customerGlobalId:
      type: string
      description: Identifiant global unique du client
    cardGlobalId:
      type: string
      description: Identifiant global unique de la carte
  put:
    displayName: Update Card Controls
    description: Met à jour les contrôles d'une carte
    body:
      application/json:
        type: CardControls?
        example:
          status: "Active"
          creditLimit: 5000.00
          controls:
            dailyPurchaseLimit: 1000.00
            dailyATMWithdrawalLimit: 500.00
            internationalTransactionsEnabled: true
            onlineTransactionsEnabled: true
    responses:
      200:
        body:
          application/json:
            type: object
      400:
        body:
          application/json:
            type: ErrorResponse
      404:
        body:
          application/json:
            type: ErrorResponse
      500:
        body:
          application/json:
            type: ErrorResponse

